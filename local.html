<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Local Preview â€” Jakob DeGazio</title>
  <link rel="stylesheet" href="style.css?v=12" />
  <script>window.SKIP_AUTO_LOAD = true;</script>
</head>
<body>
  <nav aria-label="Primary">
    <div class="nav-left">
      <span class="brand">Local Preview â€” Jakob DeGazio</span>
    </div>
    <div class="nav-right" id="navRight">
      <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">ðŸŒ™</button>
    </div>
  </nav>

  <header id="mobileProfile" class="mobile-only" role="banner">
    <div class="mobile-header">
      <div class="header-row">
        <div class="id-left">
          <img class="mobile-avatar" src="assets/portrait.jpg" alt="Jakob DeGazio headshot" />
          <h1 class="mobile-name">Jakob DeGazio</h1>
          <button id="expandBtn" class="expand-btn inline" aria-expanded="false" aria-label="Expand content">
            <svg class="chev" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true" focusable="false">
              <path fill="currentColor" d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6z"/>
            </svg>
          </button>
        </div>
        <button id="mobileThemeToggle" class="theme-toggle" aria-label="Toggle theme">ðŸŒ™</button>
      </div>
      <img class="mobile-photo profile-photo" src="assets/portrait.jpg" alt="Jakob DeGazio portrait" />
      <div class="title">IT Professional</div>
      <div class="subtitle">System Administration &amp; Endpoint Management</div>
      <div class="mobile-actions">
        <a id="dlMobile" class="download-btn" href="#" download>ðŸ“„ Download Resume</a>
        <a id="lnMobile" class="link-chip" href="#" target="_blank" rel="noopener">ðŸ”— LinkedIn</a>
      </div>
      <div class="contact-block">
        <button class="contact-toggle" aria-expanded="false">Show contact info</button>
        <div id="contactInfoMobile" class="contact-info is-hidden"></div>
      </div>
    </div>
  </header>

  <div class="resume-layout" style="margin-top:88px;">
    <aside class="sidebar desktop-only" style="text-align:left">
      <h2>Local content loader</h2>
      <p>Pick your <strong>assets/resume.json</strong> (or any JSON file). Then click <strong>Render</strong>.</p>
      <input id="fileInput" type="file" accept="application/json,.json" />
      <button id="renderBtn" class="download-btn" disabled>Render selected file</button>
      <p id="status" style="font-size:.9rem;color:var(--muted);margin-top:8px"></p>
      <hr>
      <img class="profile-photo" src="assets/portrait.jpg" alt="Jakob DeGazio portrait" />
      <h1>Jakob DeGazio</h1>
      <div class="title">IT Professional</div>
      <div class="subtitle">System Administration &amp; Endpoint Management</div>
    </aside>

    <main id="contentRoot" aria-live="polite">
      <section class="show">
        <h2>Waiting for <code>resume.json</code>â€¦</h2>
        <p>This preview does not use <code>fetch</code>. Choose your file, then click <b>Render selected file</b>.</p>
      </section>
    </main>
  </div>

  <div id="imageModal" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal__backdrop" data-close="true"></div>
    <div class="modal__dialog" role="document">
      <button class="modal__close" id="modalClose" aria-label="Close">Ã—</button>
      <img id="modalImage" alt="Jakob DeGazio portrait enlarged" />
    </div>
  </div>

  <script src="script.js?v=12"></script>
  <script>
    const fileInput = document.getElementById('fileInput');
    const renderBtn = document.getElementById('renderBtn');
    const statusEl = document.getElementById('status');
    let fileRef = null;

    fileInput.addEventListener('change', (e)=>{
      fileRef = e.target.files && e.target.files[0] || null;
      renderBtn.disabled = !fileRef;
      statusEl.textContent = fileRef ? `Selected: ${fileRef.name}` : 'No file selected';
    });

    renderBtn.addEventListener('click', ()=>{
      if (!fileRef) return;
      const reader = new FileReader();
      statusEl.textContent = 'Reading fileâ€¦';
      reader.onload = (ev)=>{
        try{
          const data = JSON.parse(ev.target.result);
          if (typeof renderResume === 'function') {
            renderResume(data);
            if (typeof buildNavFromSections === 'function') buildNavFromSections();
            statusEl.textContent = 'Rendered successfully.';
          } else {
            statusEl.textContent = 'renderResume() not found';
          }
        }catch(err){
          statusEl.textContent = 'Invalid JSON: ' + err.message;
        }
      };
      reader.onerror = ()=>{ statusEl.textContent = 'Could not read file.'; };
      reader.readAsText(fileRef);
    });
  </script>
</body>
</html>
